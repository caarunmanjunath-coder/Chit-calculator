<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chit Calculator</title>

<!-- PWA -->
<meta name="theme-color" content="#0b1220">
<link rel="manifest" href="manifest.json">

<style>
:root {
    --bg: #0b1220;
    --card: #172033;
    --input: #243147;
    --accent: #8b5cf6;
    --text: #e2e8f0;
    --muted: #94a3b8;
    --success-bg: #133d2e;
    --success-text: #22c55e;
}

* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: radial-gradient(circle at top, #0f1a30, #050b18);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
    color: var(--text);
}

.card {
    width: 100%;
    max-width: 420px;
    background: var(--card);
    padding: 28px;
    border-radius: 22px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.6);
}

h2 {
    text-align: center;
    color: var(--accent);
    margin-bottom: 28px;
}

label {
    font-size: 13px;
    color: var(--muted);
}

input, select {
    width: 100%;
    padding: 14px;
    margin: 6px 0 20px 0;
    border-radius: 14px;
    border: none;
    background: var(--input);
    color: var(--text);
    font-size: 16px;
}

#bid {
    font-size: 20px;
    font-weight: 600;
}

.result {
    text-align: center;
    font-size: 24px;
    font-weight: 700;
    padding: 20px;
    border-radius: 16px;
    background: var(--success-bg);
    color: var(--success-text);
}
</style>
</head>

<body>

<div class="card">
    <h2>Arun's Chit Calculator</h2>

    <label>Bid Amount</label>
    <input type="text" id="bid" placeholder="Enter Bid Amount"
           oninput="calculate()"
           onblur="formatOnBlur(this)">

    <label>Chit Value</label>
    <select id="installment" onchange="calculate()">
        <option value="25000">₹5 Lac</option>
        <option value="50000">₹10 Lac</option>
    </select>

    <div class="result" id="result">
        Amount to Pay: ₹ 0
    </div>
</div>

<script>

// Indian formatter
function formatIndian(num) {
    return new Intl.NumberFormat('en-IN').format(num);
}

// Format only when leaving field
function formatOnBlur(input) {
    let value = input.value.replace(/,/g, '');
    if (!isNaN(value) && value !== "") {
        input.value = formatIndian(value);
    }
}

// Main calculation
function calculate() {

    let bidRaw = document.getElementById("bid").value.replace(/,/g, '');
    let bid = parseFloat(bidRaw);
    let installment = parseFloat(document.getElementById("installment").value);

    if (isNaN(bid)) {
        document.getElementById("result").innerHTML = "Amount to Pay: ₹ 0";
        return;
    }

    // Auto commission
    let commission = (installment == 25000) ? 10000 : 20000;

    let bonus = (bid - commission) / 20;
    let amountToPay = installment - bonus;

    if (amountToPay < 0) amountToPay = 0;

    document.getElementById("result").innerHTML =
        "Amount to Pay: ₹ " + formatIndian(Math.round(amountToPay));
}

// Register service worker
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js');
}

</script>

</body>
</html>
